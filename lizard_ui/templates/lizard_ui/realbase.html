{% load utility i18n compress %}
<!DOCTYPE html>
<html>
  <head>
    <title>
      {% block title %}
        {% if view.title %}
          {# Managed properly by the view #}
          {{ view.title }}
        {% else %}
          {# By hand in the template #}
          {% block subtitle %}{% endblock subtitle%}
          {% block sitetitle %}{% endblock sitetitle%}
        {% endif %}
      {% endblock title %}
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="{{ STATIC_URL }}lizard_ui/favicon.ico" type="images/x-icon" />
    <link rel="SHORTCUT ICON" href="{{ STATIC_URL }}lizard_ui/favicon.ico" />

    {% compress css %}
      {% block css %}
        {# Twitter bootstrap, but with an included #}
        {# lizard_ui/lizard-bootstrap.less to overrides bootstrap defaults. #}
        <link rel="stylesheet"
              href="{{ STATIC_URL }}bootstrap/less/bootstrap.less"
              type="text/less"
              media="screen, projection" />
        {# Sprites: all icons (print, info, etc) in one cacheable image. #}
        <link rel="stylesheet"
              href="{{ STATIC_URL }}sprites/sprite.css"
              type="text/css"
              media="screen, projection" />
        {# CSS for jqueryui: "smoothness" theme #}
        <link type="text/css"
              href="{{ STATIC_URL }}jqueryui/smoothness/jquery-ui-1.8.11.custom.css"
              rel="stylesheet"
              media="screen, projection" />
        {# CSS for jquery-treeview #}
        <!--
        <link type="text/css"
              href="{{ STATIC_URL }}jquery-treeview/jquery.treeview.css"
              rel="stylesheet"
              media="screen, projection" />
        -->
        {# Our own css comes last #}
      {% endblock css %}
    {% endcompress %}
    <!--[if IE]>
      {% compress css %}

      {% endcompress %}
    <![endif]-->
    <!-- HTML5 shim, for IE6-8 support of HTML elements. After the styles. -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    {% compress js %}
      {% block javascript-in-head %}
        {# Should probably remain unused. #}
      {% endblock javascript-in-head %}
    {% endcompress %}
    {% block head-extras %}
      {# Your own totally-unmanaged per-template extra css/javascript/links #}
    {% endblock head-extras %}

  </head>
  <body>
    {% block page %}
      {% block header %}
        <header>
          <div id="logo-row"
               class="navbar">
            <div id="logo">
              {% block logo %}
                <a href="/"
                   title='{% trans "Back to homepage" %}'
                   ><img src="{{ STATIC_URL }}lizard_ui/logo2.png"
                         alt="Lizard" /></a>
              {% endblock logo %}
            </div>
            <div id="site-actions">
              {% block site-actions %}

                {% if view.site_actions %}
                  <ul class="nav">
                    {% for action in view.site_actions %}
                      <li
                         {% if action.description %}
                           title="{{ action.name }}"
                           data-content="{{ action.description }}"
                           class="has_popover"
                         {% endif %}
                         >
                        <a href="{{ action.url }}"
                           class="{{ action.klass }}">
                          {% if action.icon %}
                            <i class="{{ action.icon }} icon-white"></i>
                          {% endif %}
                          {{ action.name }}
                        </a>
                      </li>
                    {% endfor %}
                  </ul>
                {% endif %}

              {% endblock site-actions %}
            </div>
          </div>

          <div id="breadcrumb-row"
               class="navbar">
            <div id="breadcrumbs">
              {% block breadcrumbs %}

                {% if view.breadcrumbs %}
                  <ul>
                    {% for action in view.breadcrumbs %}
                      <li
                         {% if action.description %}
                           title="{{ action.name }}"
                           data-content="{{ action.description }}"
                           class="has_popover"
                         {% endif %}
                         >
                        <a href="{{ action.url }}"
                           class="{{ action.klass }}">
                          {% if action.icon %}
                            <i class="{{ action.icon }}"></i>
                          {% endif %}
                          {{ action.name }}
                        </a>
                        {% if not forloop.last %}
                          &rarr;
                        {% endif %}
                      </li>
                    {% endfor %}
                  </ul>
                {% endif %}

              {% endblock breadcrumbs %}
            </div>
            <div id="content-actions">
              {% block content-actions %}

                {% if view.content_actions %}
                  <ul class="nav">
                    {% for action in view.content_actions %}
                      <li
                         {% if action.description %}
                           title="{{ action.name }}"
                           data-content="{{ action.description }}"
                           class="has_popover"
                         {% endif %}
                         >
                        <a href="{{ action.url }}"
                           class="{{ action.klass }}">
                          {% if action.icon %}
                            <i class="{{ action.icon }}"></i>
                          {% endif %}
                          {{ action.name }}
                        </a>
                      </li>
                    {% endfor %}
                  </ul>
                {% endif %}

              {% endblock content-actions %}
            </div>
          </div>

        </header>
      {% endblock header %}

      {% block main-area %}
        <div id="sidebar">
          <div id="sidebar-inner">
            {% block sidebar %}
              {% if application_screen_slug %}
                {% application_icons application_screen_slug %}
              {% endif %}
            {% endblock sidebar %}
            <div id="layers">
              <h2>{% trans "Layers" %}</h2>
              {% block layers %}
              {% endblock layers%}
              <ul style="list-style: none;margin:0;width:279px;">
                <!-- TODO: Replace these hardcoded placeholder layers: -->
                <li><a href="#"><div class="workspace-acceptable">Layer 1</div></a></li>
                <li><a href="#"><div class="workspace-acceptable">Layer 2</div></a></li>
                <li><a href="#"><div class="workspace-acceptable">Layer 3</div></a></li>
                <li><a href="#"><div class="workspace-acceptable">Layer 4</div></a></li>
              </ul>
            </div>
          </div>
        </div>

        <div id="content">
          {% block content %}
          {% endblock content %}
        </div>

        <div id="footer">
          <div id="sidebar-actions">
            {% block sidebar-actions %}

              {% if view.sidebar_actions %}
                <div class="btn-toolbar">
                  <div class="btn-group">

                    {% for action in view.sidebar_actions %}
                      <a href="{{ action.url }}"
                        {% if action.description %}
                          title="{{ action.name }}"
                          data-content="{{ action.description }}"
                          class="has_popover btn {{ action.klass }}"
                        {% else %}
                          class="btn {{ action.klass }}"
                        {% endif %}
                        >
                        {% if action.icon %}
                          <i class="{{ action.icon }}"></i>
                        {% endif %}
                        {{ action.name }}
                      </a>
                    {% endfor %}

                  </div>
                </div>
              {% endif %}

            {% endblock sidebar-actions %}
          </div>
          <div id="orthogonal-actions">
            {% block orthogonal-actions %}

              {% if view.orthogonal_action_groups %}
                <div class="btn-toolbar">
                  {% for group in view.orthogonal_action_groups %}
                    <div class="btn-group">

                      {% for action in group %}
                        <a href="{{ action.url }}"
                          {% if action.description %}
                            title="{{ action.name }}"
                            data-content="{{ action.description }}"
                            class="has_popover btn {{ action.klass }}"
                          {% else %}
                            class="btn {{ action.klass }}"
                          {% endif %}
                          >
                          {% if action.icon %}
                            <i class="{{ action.icon }}"></i>
                          {% endif %}
                          {{ action.name }}
                        </a>
                      {% endfor %}
                    {% endfor %}
                  {% endif %}

                </div>
              </div>

            {% endblock orthogonal-actions %}
          </div>
        </div>
      {% endblock main-area %}

    {% endblock page %}

     {# Ajax calls need a CSRF token cookie, and this line sends one as a side effect #}
     <!-- {{ csrf_token }} -->

     {# Minimized jquery and bootstrap scripts. Minimizing with #}
     {# django-compressor failed. #}
     <script type="text/javascript"
             src="{{ STATIC_URL }}jquery/jquery.min.js"></script>
     <script type="text/javascript"
             src="{{ STATIC_URL }}bootstrap/bootstrap.min.js"></script>

    {% compress js %}
      {% block javascript %}
        {# Jquery, jqueryui jquerytools and jstree #}
        <!--
        <script type="text/javascript"
                src="{{ STATIC_URL }}jqueryui/jqueryui.min.js"></script>
        <script type="text/javascript"
                src="{{ STATIC_URL }}jqueryui/jquery.ui.datepicker-nl.js"></script>
        <script type="text/javascript"
                src="{{ STATIC_URL
                }}jquery-treeview/jquery.treeview.js"></script>
        <script type="text/javascript"
                src="{{ STATIC_URL }}lizard_ui/lizard.js"></script>
        -->
        <script type="text/javascript"
                src="{{ STATIC_URL }}lizard_ui/csrf.js"></script>
        <script type="text/javascript"
                src="{{ STATIC_URL }}lizard_ui/lizardui.js"></script>
        <script type="text/javascript"
                src="{{ STATIC_URL }}datatables/media/js/jquery.dataTables.min.js"></script>
        <script type="text/javascript"
                src="{{ STATIC_URL }}colorpicker/js/colorpicker.js"></script>

      {% endblock javascript %}
    {% endcompress %}

    {% block map-javascript %}
      {# For lizard-map's wms handling #}
    {% endblock map-javascript %}

    {% if google_tracking_code %}
      <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', '{{ google_tracking_code }}']);
        _gaq.push(['_trackPageview']);
        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      </script>
    {% endif %}

    {% block bottom-extras %}
      {# Your own totally-unmanaged per-template extra css/javascript/links #}
    {% endblock bottom-extras %}

  </body>
</html>
